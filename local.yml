---
# Harmonize my systems rather than doing everything manually. :)

# Everything
- name: Initial Setup
  hosts: all, localhost
  connection: local
  become: true  

  pre_tasks:
    - include: facts/system.yml
    - include: facts/package.yml
    - include: facts/service.yml
    - include: facts/user.yml

  tasks:
    - include: tasks/general/packages.yml
    - include: tasks/general/groups.yml
    - include: tasks/general/users.yml
    - include: tasks/general/cron.yml
    - include: tasks/general/sudo.yml
    - include: tasks/general/harden.yml
      ignore_errors: yes


# Workstations
- name: UI Setup
  hosts: workstation
  connection: local
  become: true

  tasks:
    - include: tasks/linux/flatpaks.yml
      when: ansible_system == "Linux" and
            flatpak_distro == yes
    - shell: echo "Not implemented yet. :("
      when: ansible_system == "Linux" and
            flatpak_distro == no
    - include: tasks/freebsd/gui.yml
      when: ansible_system == "FreeBSD"


# Run Hardness Checks
- name: Hardening Check
  hosts: all, localhost
  connection: local
  become: true

  tasks:
    - include: tasks/general/hardness_check_lynis.yml